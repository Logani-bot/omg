# Windows 작업 스케줄러 설정 가이드

## 📋 개요
컴퓨터를 끄더라도, 켤 때마다 자동으로 Envelope Alert를 실행합니다.

---

## 🚀 빠른 설정 (10분 간격 실행)

### 1단계: 작업 스케줄러 열기
1. `Windows 키` + `R` 누르기
2. `taskschd.msc` 입력 후 엔터
3. 또는 시작 메뉴에서 "작업 스케줄러" 검색

### 2단계: 새 작업 만들기
1. 오른쪽 패널에서 **"기본 작업 만들기"** 클릭
2. 이름: `Envelope Alert Monitor`
3. 설명: `암호화폐 Envelope 하단선 근접 알림` (선택사항)
4. **다음** 클릭

### 3단계: 트리거 설정
1. **"매일"** 선택 → 다음
2. 시작 날짜/시간: 오늘 날짜, 원하는 시작 시간 (예: 오전 9:00)
3. **다음** 클릭

### 4단계: 작업 설정
1. **"프로그램 시작"** 선택 → 다음
2. **프로그램/스크립트**: 
   ```
   C:\Coding\OMG\run_envelope_alert.bat
   ```
   (또는 찾아보기로 `run_envelope_alert.bat` 선택)
3. **시작 위치** (선택사항):
   ```
   C:\Coding\OMG
   ```
4. **다음** 클릭

### 5단계: 반복 설정 (중요!)
1. **"마침"** 클릭하기 전에 **"마침을 클릭할 때 속성 대화 상자 열기"** 체크
2. **마침** 클릭
3. 속성 창이 열리면:
   - **"트리거"** 탭 클릭
   - 방금 만든 트리거 더블클릭
   - **"고급 설정"** 섹션에서:
     - ✅ **"작업 반복 간격"** 체크
     - 간격: **10분** (또는 원하는 간격)
     - 기간: **1일**
     - ✅ **"사용"** 체크
   - **확인** 클릭
4. **확인** 클릭하여 속성 창 닫기

---

## ⚙️ 고급 설정 (선택사항)

### 부팅 시 자동 시작
1. 작업 스케줄러에서 만든 작업 더블클릭
2. **"트리거"** 탭
3. **"새로 만들기"** 클릭
4. **"작업 시작"**: "시작할 때" 선택
5. **확인**

### 배터리 절약 모드에서도 실행
1. 작업 속성 → **"조건"** 탭
2. ❌ **"컴퓨터의 AC 전원이 켜져 있는 경우에만 작업 시작"** 체크 해제

### 놓친 작업 즉시 실행
1. 작업 속성 → **"설정"** 탭
2. ✅ **"예약된 시작 시간을 놓친 경우 가능한 빨리 작업 실행"** 체크

---

## 🧪 테스트

### 수동 실행 테스트
1. 작업 스케줄러에서 만든 작업 선택
2. 오른쪽 패널에서 **"실행"** 클릭
3. 텔레그램으로 메시지가 오는지 확인 (알림 대상 코인이 있는 경우)

### 로그 확인
- 에러 발생 시: `C:\Coding\OMG\envelope_alert_error.log` 확인
- 정상 실행 시: 로그 파일 생성 안 됨

---

## 📊 실행 간격 추천

| 간격 | 용도 | 하루 실행 횟수 |
|------|------|----------------|
| **5분** | 적극적 모니터링 | 288회 |
| **10분** | 균형 잡힌 모니터링 (권장) | 144회 |
| **15분** | 일반 모니터링 | 96회 |
| **30분** | 여유로운 모니터링 | 48회 |
| **1시간** | 최소 모니터링 | 24회 |

---

## 🔧 문제 해결

### "작업이 실행되지 않습니다"
1. 작업 속성 → **"일반"** 탭
2. **"사용자가 로그온할 때만 실행"** 선택
3. 또는 **"사용자의 로그온 여부에 관계없이 실행"** 선택 후 비밀번호 입력

### "Python을 찾을 수 없습니다"
1. `run_envelope_alert.bat` 파일 수정:
   ```batch
   @echo off
   cd /d C:\Coding\OMG
   C:\Users\YourUsername\AppData\Local\Programs\Python\Python311\python.exe envelope_alert.py
   ```
2. Python 전체 경로 확인:
   ```cmd
   where python
   ```

### "모듈을 찾을 수 없습니다"
1. 가상환경 사용 시 `run_envelope_alert.bat` 수정:
   ```batch
   @echo off
   cd /d C:\Coding\OMG
   call venv\Scripts\activate
   python envelope_alert.py
   ```

---

## 🎯 최종 확인 체크리스트

- [ ] 텔레그램 봇 설정 완료 (`.env` 파일)
- [ ] `run_envelope_alert.bat` 파일 생성
- [ ] 작업 스케줄러에 작업 등록
- [ ] 반복 간격 설정 (10분 권장)
- [ ] 수동 실행 테스트 성공
- [ ] 로그 파일 경로 확인

---

## 💡 추가 팁

### 여러 간격으로 실행하기
- **빠른 체크**: 10분 간격 (시장 변동성 높을 때)
- **느린 체크**: 1시간 간격 (야간/주말)

→ 작업을 2개 만들어서 시간대별로 다른 간격 설정 가능

### 실행 시간대 제한
1. 트리거 설정에서 **"시작"** 시간과 **"기간"** 조정
2. 예: 오전 9시~오후 6시만 실행 → 기간 9시간

---

문제가 있으면 `envelope_alert_error.log` 파일을 확인하세요!

